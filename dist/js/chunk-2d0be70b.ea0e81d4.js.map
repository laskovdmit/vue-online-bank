{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/loginForm.js","webpack:///./src/views/Auth.vue?59b5"],"names":["for","class","onSubmit","eError","type","id","email","eBlur","pError","password","pBlur","disabled","isSubmitting","isTooManyAttempts","useLoginForm","store","useStore","router","useRouter","useForm","handleSubmit","submitCount","useField","yup","trim","required","value","errorMessage","handleBlur","MIN_LENGTH","min","computed","watch","val","setTimeout","values","console","log","dispatch","push","setup","route","query","message","error","__exports__","render"],"mappings":"2IAEQ,eAAwB,UAApB,mBAAe,G,EAGf,eAAgC,SAAzBA,IAAI,SAAQ,SAAK,G,YAMxB,eAAoC,SAA7BA,IAAI,YAAW,UAAM,G,mBAM3BC,MAAM,e,gDAhBf,eAmBO,QAnBDA,MAAM,OAAQ,SAAM,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CACxC,EAEA,eAIM,OAJAD,MAAK,yBAA6B,EAAAE,U,CACpC,E,eACA,eAA6D,SAAtDC,KAAK,QAAQC,GAAG,Q,qDAAiB,EAAAC,MAAK,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAd,EAAAD,SAC3B,EAAAH,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGlC,eAIM,OAJAF,MAAK,yBAA6B,EAAAO,U,CACpC,E,eACA,eAAsE,SAA/DJ,KAAK,WAAWC,GAAG,W,qDAAoB,EAAAI,SAAQ,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAjB,EAAAD,YACjC,EAAAD,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGlC,eAAsG,UAA9FP,MAAM,cAAcG,KAAK,SAAUO,SAAU,EAAAC,cAAgB,EAAAC,mBAAmB,QAAK,gBAC9D,EAAAA,mB,iBAA/B,eAEM,MAFN,EAAkD,mE,mJCX3C,SAASC,IACpB,IAAMC,EAAQC,iBACRC,EAASC,iBAFoB,EAGiBC,iBAA5CC,EAH2B,EAG3BA,aAAcR,EAHa,EAGbA,aAAcS,EAHD,EAGCA,YAHD,EAK+BC,eAC9D,QACAC,SAEKC,OACAC,SAAS,6BACTnB,MAAM,uCANAA,EALoB,EAK3BoB,MAA4BvB,EALD,EAKbwB,aAAkCpB,EALrB,EAKSqB,WAStCC,EAAa,EAdgB,EAgBkCP,eACjE,WACAC,SAEKC,OACAC,SAAS,8BACTK,IAAID,EAJT,sCAIoDA,EAJpD,gBAFWpB,EAhBoB,EAgB3BiB,MAA+BlB,EAhBJ,EAgBVmB,aAAkCjB,EAhBxB,EAgBYkB,WASzCf,EAAoBkB,gBAAS,kBAAMV,EAAYK,OAAS,KAE9DM,eAAMnB,GAAmB,SAAAoB,GACjBA,GACAC,YAAW,kBAAMb,EAAYK,MAAQ,IAAG,SAIhD,IAAMxB,EAAWkB,EAAY,yDAAC,WAAMe,GAAN,wFAC1BC,QAAQC,IAAI,OAAQF,GADM,kBAIhBpB,EAAMuB,SAAS,aAAcH,GAJb,OAKtBlB,EAAOsB,KAAK,KALU,0GAAD,uDAS7B,MAAO,CACHjC,QACAG,WACAN,SACAK,SACAD,QACAG,QACAR,WACAU,eACAC,qBD5BO,OACX2B,MADW,WAEP,IAAMC,EAAQ,iBACR1B,EAAQ,iBAUd,OARI0B,EAAMC,MAAMC,SACZ5B,EAAMuB,SAAS,aAAc,CACzBZ,MAAO,OAAAkB,EAAA,MAAMH,EAAMC,MAAMC,SACzBvC,KAAM,YAKd,kBACOU,O,qBEtCf,MAAM+B,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d0be70b.ea0e81d4.js","sourcesContent":["<template>\r\n    <form class=\"card\" @submit.prevent=\"onSubmit\">\r\n        <h1>Войти в систему</h1>\r\n\r\n        <div :class=\"['form-control', {invalid: eError}]\">\r\n            <label for=\"email\">Email</label>\r\n            <input type=\"email\" id=\"email\" v-model=\"email\" @blur=\"eBlur\">\r\n            <small v-if=\"eError\">{{ eError }}</small>\r\n        </div>\r\n\r\n        <div :class=\"['form-control', {invalid: pError}]\">\r\n            <label for=\"password\">Пароль</label>\r\n            <input type=\"password\" id=\"password\" v-model=\"password\" @blur=\"pBlur\">\r\n            <small v-if=\"pError\">{{ pError }}</small>\r\n        </div>\r\n\r\n        <button class=\"btn primary\" type=\"submit\" :disabled=\"isSubmitting || isTooManyAttempts\">Войти</button>\r\n        <div class=\"text-danger\" v-if=\"isTooManyAttempts\">\r\n            Вы слишком часто пытаетесь войти в систему, попробуйте позже\r\n        </div>\r\n    </form>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from 'vue-router'\r\nimport { useStore } from 'vuex';\r\nimport { error } from '../utils/error';\r\nimport useLoginForm from '../use/loginForm'\r\n\r\nexport default {\r\n    setup() {\r\n        const route = useRoute();\r\n        const store = useStore();\r\n\r\n        if (route.query.message) {\r\n            store.dispatch('setMessage', {\r\n                value: error(route.query.message),\r\n                type: 'warning'\r\n            });\r\n        }\r\n\r\n\r\n        return {\r\n            ...useLoginForm()\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","import { computed, watch } from 'vue'\r\nimport * as yup from 'yup'\r\nimport { useField, useForm } from 'vee-validate'\r\nimport { useStore } from 'vuex';\r\nimport { useRouter } from 'vue-router'\r\n\r\nexport default function useLoginForm() {\r\n    const store = useStore();\r\n    const router = useRouter();\r\n    const { handleSubmit, isSubmitting, submitCount } = useForm();\r\n\r\n    const { value: email, errorMessage: eError, handleBlur: eBlur } = useField(\r\n        'email',\r\n        yup\r\n            .string()\r\n            .trim()\r\n            .required('Пожалуйста, введите email')\r\n            .email('Необходимо ввести корректный email')\r\n    );\r\n\r\n    const MIN_LENGTH = 6;\r\n\r\n    const { value: password, errorMessage: pError, handleBlur: pBlur } = useField(\r\n        'password',\r\n        yup\r\n            .string()\r\n            .trim()\r\n            .required('Пожалуйста, введите пароль')\r\n            .min(MIN_LENGTH, `Пароль не может быть меньше ${MIN_LENGTH} символов.`)\r\n    );\r\n\r\n    const isTooManyAttempts = computed(() => submitCount.value >= 3);\r\n\r\n    watch(isTooManyAttempts, val => {\r\n        if (val) {\r\n            setTimeout(() => submitCount.value = 0, 1500);\r\n        }\r\n    });\r\n\r\n    const onSubmit = handleSubmit(async values => {\r\n        console.log('Form', values);\r\n\r\n        try {\r\n            await store.dispatch('auth/login', values);\r\n            router.push('/');\r\n        } catch (e) {}\r\n    });\r\n\r\n    return {\r\n        email,\r\n        password,\r\n        eError,\r\n        pError,\r\n        eBlur,\r\n        pBlur,\r\n        onSubmit,\r\n        isSubmitting,\r\n        isTooManyAttempts\r\n    }\r\n};","import { render } from \"./Auth.vue?vue&type=template&id=fb4eb6ce\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\Программирование\\\\3. Vue\\\\14 задание\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}